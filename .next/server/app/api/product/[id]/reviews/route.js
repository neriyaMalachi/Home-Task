"use strict";(()=>{var e={};e.id=799,e.ids=[799],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6249:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>y,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>v});var i={};t.r(i),t.d(i,{POST:()=>p});var o=t(9303),n=t(8716),a=t(3131),s=t(7070),u=t(2850),d=t(3683);async function p(e,{params:r}){await (0,u.v)();let t=r.id;try{let{reviewer:r,rating:i,comment:o}=await e.json();if(!r||!i||!o)return s.NextResponse.json({error:"All fields are required"},{status:400});let n=await d.O.findById(t);if(!n)return s.NextResponse.json({error:"Product not found"},{status:404});return n.reviews.push({reviewer:r,rating:i,comment:o}),await n.save(),s.NextResponse.json({message:"Review added successfully",product:n})}catch(e){return console.error("Error adding review:",e),s.NextResponse.json({error:"Internal Server Error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/product/[id]/reviews/route",pathname:"/api/product/[id]/reviews",filename:"route",bundlePath:"app/api/product/[id]/reviews/route"},resolvedPagePath:"C:\\Users\\Neriya Malachi\\Desktop\\home-work\\src\\app\\api\\product\\[id]\\reviews\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:v,serverHooks:m}=c,w="/api/product/[id]/reviews/route";function y(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:v})}},2850:(e,r,t)=>{t.d(r,{v:()=>a});var i=t(1185),o=t.n(i);let n=process.env.MONGODB_URI||"";if(!n)throw Error("Missing MONGODB_URI in .env file");let a=async()=>{o().connection.readyState>=1||await o().connect(n)}},3683:(e,r,t)=>{t.d(r,{O:()=>s});var i=t(1185),o=t.n(i);let n=new i.Schema({_id:{type:o().Schema.Types.ObjectId,auto:!0},reviewer:{type:String,required:!0},rating:{type:Number,required:!0,min:1,max:5},comment:{type:String,required:!0},createdAt:{type:Date,default:Date.now}}),a=new i.Schema({name:{type:String,required:!0,unique:!0},description:{type:String,required:!0},price:{type:Number,required:!0},image:{type:String,required:!0},reviews:{type:[n],default:[]}}),s=i.models.Product||(0,i.model)("Product",a)}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[276,972],()=>t(6249));module.exports=i})();